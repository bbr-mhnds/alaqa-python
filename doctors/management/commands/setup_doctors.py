from django.core.management.base import BaseCommand; from doctors.models import Doctor; from django.contrib.auth import get_user_model; from django.contrib.auth.models import Group; User = get_user_model(); class Command(BaseCommand): def handle(self, *args, **options): doctors_group = Group.objects.get_or_create(name="Doctors")[0]; for doctor in Doctor.objects.all(): user, created = User.objects.get_or_create(email=doctor.email, defaults={"is_staff": True, "is_active": True}); if created: user.set_password("Alaqa@2024"); user.groups.add(doctors_group); user.save(); print(f"Created user for {doctor.email}"); else: user.is_active = True; user.is_staff = True; user.groups.add(doctors_group); user.save(); print(f"Updated user for {doctor.email}"); Doctor.objects.all().update(status="approved")
